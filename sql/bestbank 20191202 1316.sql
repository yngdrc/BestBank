--
-- Script was generated by Devart dbForge Studio 2019 for MySQL, Version 8.2.23.0
-- Product home page: http://www.devart.com/dbforge/mysql/studio
-- Script date 02.12.2019 13:16:42
-- Server version: 5.5.5-10.3.18-MariaDB-50+deb10u1.cba
-- Client version: 4.1
--


-- 
-- Set SQL mode
-- 
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;

-- 
-- Set character set the client will use to send SQL statements to the server
--
SET NAMES 'utf8';

DROP DATABASE IF EXISTS bestbank;

CREATE DATABASE bestbank
	CHARACTER SET latin1
	COLLATE latin1_general_ci;

--
-- Set default database
--
USE bestbank;

--
-- Create table `TransactionTypes`
--
CREATE TABLE TransactionTypes (
  TransactionType VARCHAR(8) NOT NULL CHECK (TransactionType in ('Transfer','Payment','ATM')),
  PRIMARY KEY (TransactionType)
)
ENGINE = MYISAM,
AVG_ROW_LENGTH = 20,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create table `Transactions`
--
CREATE TABLE Transactions (
  TransactionNumber CHAR(18) NOT NULL CHECK (TransactionNumber regexp '^[0-9]+$'),
  TransactionType VARCHAR(8) NOT NULL,
  PayerCardNumber CHAR(16) DEFAULT NULL,
  PayerAccountNumber CHAR(26) DEFAULT NULL CHECK (PayerAccountNumber regexp '^[0-9]+$'),
  RecipientAccountNumber CHAR(26) DEFAULT NULL CHECK (RecipientAccountNumber regexp '^[0-9]+$'),
  PayerName VARCHAR(100) NOT NULL CHECK (PayerName regexp cast('^[A-Z]' as char charset binary) and PayerName regexp '^.[a-z[:space:]]+$'),
  PayerStreet VARCHAR(100) DEFAULT NULL,
  PayerStreetNumber VARCHAR(5) DEFAULT NULL CHECK (PayerStreetNumber regexp '^[0-9]+$'),
  PayerHouseOrFlatNo VARCHAR(10) DEFAULT NULL CHECK (PayerHouseOrFlatNo regexp '^[0-9]+$' or PayerHouseOrFlatNo regexp '^[a-z]+$'),
  PayerPostalCode VARCHAR(20) DEFAULT NULL,
  PayerCity VARCHAR(100) DEFAULT NULL CHECK (PayerCity regexp cast('^[A-Z]' as char charset binary) and PayerCity regexp '^.[a-z[:space:]]+$'),
  RecipientName VARCHAR(100) NOT NULL CHECK (RecipientName regexp cast('^[A-Z]' as char charset binary) and RecipientName regexp '^.[a-z[:space:]]+$'),
  RecipientStreet VARCHAR(100) DEFAULT NULL,
  RecipientStreetNumber VARCHAR(5) DEFAULT NULL CHECK (RecipientStreetNumber regexp '^[0-9]+$'),
  RecipientHouseOrFlatNo VARCHAR(10) DEFAULT NULL CHECK (RecipientHouseOrFlatNo regexp '^[0-9]+$' or RecipientHouseOrFlatNo regexp '^[a-z]+$'),
  RecipientPostalCode VARCHAR(20) DEFAULT NULL,
  RecipientCity VARCHAR(100) DEFAULT NULL CHECK (RecipientCity regexp cast('^[A-Z]' as char charset binary) and RecipientCity regexp '^.[a-z[:space:]]+$'),
  TransactionTitle VARCHAR(100) NOT NULL,
  TransactionDate DATE NOT NULL CHECK (TransactionDate > '2019-11-19'),
  Amount DECIMAL(10, 0) NOT NULL CHECK (Amount > 0),
  PRIMARY KEY (TransactionNumber)
)
ENGINE = MYISAM,
AVG_ROW_LENGTH = 168,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create index `fk_trans_PayerCardNumber` on table `Transactions`
--
ALTER TABLE Transactions 
  ADD INDEX fk_trans_PayerCardNumber(PayerCardNumber);

--
-- Create index `fk_trans_TransactionType` on table `Transactions`
--
ALTER TABLE Transactions 
  ADD INDEX fk_trans_TransactionType(TransactionType);

--
-- Create table `TransactionHistories`
--
CREATE TABLE TransactionHistories (
  TransactionNumber CHAR(18) NOT NULL,
  PayerEmail VARCHAR(100) DEFAULT NULL CHECK (PayerEmail regexp '^.+@[a-z]+\\.[a-z]+$'),
  PayerAreaCode VARCHAR(20) NOT NULL CHECK (PayerAreaCode regexp '^\\+?[0-9]+$'),
  PayerPhoneNumber VARCHAR(30) DEFAULT NULL CHECK (PayerPhoneNumber regexp '^[0-9]+$'),
  RecipientEmail VARCHAR(100) DEFAULT NULL CHECK (RecipientEmail regexp '^.+@[a-z]+\\.[a-z]+$'),
  RecipientAreaCode VARCHAR(20) NOT NULL CHECK (RecipientAreaCode regexp '^\\+?[0-9]+$'),
  RecipientPhoneNumber VARCHAR(30) DEFAULT NULL CHECK (RecipientPhoneNumber regexp '^[0-9]+$')
)
ENGINE = MYISAM,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create index `fk_th_TransactionNumber` on table `TransactionHistories`
--
ALTER TABLE TransactionHistories 
  ADD INDEX fk_th_TransactionNumber(TransactionNumber);

--
-- Create table `Temp`
--
CREATE TABLE Temp (
  Username VARCHAR(16) NOT NULL,
  Password VARCHAR(60) NOT NULL,
  Balance DOUBLE NOT NULL
)
ENGINE = MYISAM,
AVG_ROW_LENGTH = 100,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create table `LoginDates`
--
CREATE TABLE LoginDates (
  IdentityNumber VARCHAR(30) NOT NULL,
  LoginDate DATE NOT NULL CHECK (LoginDate > '2019-11-19 00:00:00'),
  WasSuccesful BIT(1) NOT NULL
)
ENGINE = MYISAM,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create index `fk_ld_IdentityNumber` on table `LoginDates`
--
ALTER TABLE LoginDates 
  ADD INDEX fk_ld_IdentityNumber(IdentityNumber);

--
-- Create table `JunctionTable`
--
CREATE TABLE JunctionTable (
  TransactionNumber CHAR(18) NOT NULL,
  AccountNumber CHAR(26) NOT NULL
)
ENGINE = MYISAM,
AVG_ROW_LENGTH = 45,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create index `fk_jt_AccountNumber` on table `JunctionTable`
--
ALTER TABLE JunctionTable 
  ADD INDEX fk_jt_AccountNumber(AccountNumber);

--
-- Create index `fk_jt_TransactionNumber` on table `JunctionTable`
--
ALTER TABLE JunctionTable 
  ADD INDEX fk_jt_TransactionNumber(TransactionNumber);

--
-- Create table `Customers`
--
CREATE TABLE Customers (
  IdentityNumber VARCHAR(30) NOT NULL CHECK (IdentityNumber regexp '^[0-9]+$'),
  Email VARCHAR(100) NOT NULL CHECK (Email regexp '^.+@[a-z]+\\.[a-z]+$'),
  LastName VARCHAR(100) NOT NULL CHECK (LastName regexp cast('^[A-Z]' as char charset binary) and LastName regexp '^.[a-z[:space:]]+$'),
  FirstName VARCHAR(100) NOT NULL CHECK (FirstName regexp cast('^[A-Z]' as char charset binary) and FirstName regexp '^.[a-z[:space:]]+$'),
  BirthDate DATE NOT NULL,
  AreaCode VARCHAR(20) NOT NULL CHECK (AreaCode regexp '^\\+?[0-9]+$'),
  PhoneNumber VARCHAR(30) NOT NULL CHECK (PhoneNumber regexp '^[0-9]+$'),
  TitleOfCourtesy VARCHAR(4) NOT NULL CHECK (TitleOfCourtesy in ('Mr.','Mrs.')),
  UserName CHAR(10) NOT NULL CHECK (UserName regexp cast('^[a-z]{4}' as char charset binary) and UserName regexp '[0-9]{4}$'),
  UserPassword VARCHAR(72) NOT NULL,
  RegisterDate DATE NOT NULL CHECK (RegisterDate > '2019-11-19'),
  ProfileStatus VARCHAR(8) NOT NULL CHECK (ProfileStatus in ('Active','Inactive')),
  PRIMARY KEY (IdentityNumber)
)
ENGINE = MYISAM,
AVG_ROW_LENGTH = 139,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create index `Email` on table `Customers`
--
ALTER TABLE Customers 
  ADD UNIQUE INDEX Email(Email);

--
-- Create index `UserName` on table `Customers`
--
ALTER TABLE Customers 
  ADD UNIQUE INDEX UserName(UserName);

--
-- Create table `CreditCards`
--
CREATE TABLE CreditCards (
  CardNumber CHAR(16) NOT NULL CHECK (CardNumber regexp '^[0-9]+$'),
  CardType VARCHAR(12) NOT NULL,
  AssociatedAccount CHAR(26) NOT NULL CHECK (AssociatedAccount regexp '^[0-9]{2}12345678[0-9]+$'),
  ExpirationDate DATE NOT NULL,
  PCVCode CHAR(3) NOT NULL CHECK (PCVCode regexp '^[0-9]+$'),
  IssueDate DATE NOT NULL CHECK (IssueDate > '2019-11-19'),
  CardStatus VARCHAR(8) NOT NULL CHECK (CardStatus in ('Active','Inactive')),
  CancellationDate DATE DEFAULT NULL CHECK (CancellationDate > IssueDate),
  PRIMARY KEY (CardNumber)
)
ENGINE = MYISAM,
AVG_ROW_LENGTH = 76,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create index `fk_cc_CardType` on table `CreditCards`
--
ALTER TABLE CreditCards 
  ADD INDEX fk_cc_CardType(CardType);

--
-- Create index `PCVCode` on table `CreditCards`
--
ALTER TABLE CreditCards 
  ADD UNIQUE INDEX PCVCode(PCVCode);

--
-- Create table `CardTypes`
--
CREATE TABLE CardTypes (
  CardType VARCHAR(12) NOT NULL CHECK (CardType in ('Payment card','Debit card')),
  PRIMARY KEY (CardType)
)
ENGINE = MYISAM,
AVG_ROW_LENGTH = 20,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create table `Adresses`
--
CREATE TABLE Adresses (
  AdressID SMALLINT(6) NOT NULL AUTO_INCREMENT,
  IdentityNumber VARCHAR(30) NOT NULL,
  AdressType VARCHAR(21) NOT NULL CHECK (AdressType in ('Adress','Correspondence adress','Registered adress')),
  Street VARCHAR(100) NOT NULL,
  StreetNumber VARCHAR(5) NOT NULL CHECK (StreetNumber regexp '^[0-9]+$'),
  HouseOrFlatNo VARCHAR(10) NOT NULL CHECK (HouseOrFlatNo regexp '^[0-9]+$' or HouseOrFlatNo regexp '^[a-z]+$'),
  PostalCode VARCHAR(20) NOT NULL,
  City VARCHAR(100) NOT NULL CHECK (City regexp cast('^[A-Z]' as char charset binary) and City regexp '^.[a-z[:space:]]+$'),
  Country VARCHAR(100) NOT NULL CHECK (Country regexp cast('^[A-Z]' as char charset binary) and Country regexp '^.[a-z[:space:]]+$'),
  AdressEntryDate DATE NOT NULL CHECK (AdressEntryDate > '2019-11-19'),
  AdressStatus VARCHAR(11) NOT NULL CHECK (AdressStatus in ('Actual','Outdated')),
  AdressChangeDate DATE DEFAULT NULL CHECK (AdressChangeDate > AdressEntryDate),
  PRIMARY KEY (AdressID)
)
ENGINE = MYISAM,
AUTO_INCREMENT = 7,
AVG_ROW_LENGTH = 92,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create index `fk_adr_IdentityNumber` on table `Adresses`
--
ALTER TABLE Adresses 
  ADD INDEX fk_adr_IdentityNumber(IdentityNumber);

--
-- Create table `AccountTypes`
--
CREATE TABLE AccountTypes (
  AccountType VARCHAR(16) NOT NULL CHECK (AccountType in ('Personal account','Savings account','Comfort')),
  PRIMARY KEY (AccountType)
)
ENGINE = MYISAM,
AVG_ROW_LENGTH = 20,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create table `Accounts`
--
CREATE TABLE Accounts (
  AccountNumber CHAR(26) NOT NULL CHECK (AccountNumber regexp '^[0-9]{2}12345678[0-9]+$'),
  AccountType VARCHAR(16) NOT NULL,
  IdentityNumber VARCHAR(30) NOT NULL,
  AccountName VARCHAR(50) NOT NULL,
  Balance DECIMAL(10, 0) NOT NULL,
  OpeningDate DATE NOT NULL CHECK (OpeningDate > '2019-11-19'),
  AccountStatus VARCHAR(8) NOT NULL CHECK (AccountStatus in ('Active','Inactive')),
  ClosingDate DATE DEFAULT NULL CHECK (ClosingDate > OpeningDate),
  PRIMARY KEY (AccountNumber)
)
ENGINE = MYISAM,
AVG_ROW_LENGTH = 87,
CHARACTER SET latin1,
CHECKSUM = 0,
COLLATE latin1_general_ci;

--
-- Create index `fk_acc_AccountType` on table `Accounts`
--
ALTER TABLE Accounts 
  ADD INDEX fk_acc_AccountType(AccountType);

--
-- Create index `fk_acc_IdentityNumber` on table `Accounts`
--
ALTER TABLE Accounts 
  ADD INDEX fk_acc_IdentityNumber(IdentityNumber);

-- 
-- Dumping data for table TransactionTypes
--
INSERT INTO TransactionTypes VALUES
('ATM'),
('Payment'),
('Transfer');

-- 
-- Dumping data for table Transactions
--
INSERT INTO Transactions VALUES
('201911190101010101', 'ATM', '4215658072204550', NULL, '26123456785647385647382905', 'William Smith', NULL, NULL, NULL, NULL, NULL, 'William Smith', 'Second', '56', 'a', '94203', 'Beverly Hills', 'Cash deposit 19.11.2019', '2019-11-19', 3500);

-- 
-- Dumping data for table TransactionHistories
--
-- Table bestbank.TransactionHistories does not contain any data (it is empty)

-- 
-- Dumping data for table Temp
--
INSERT INTO Temp VALUES
('wilsmi0011', '$2y$10$OUVn2Biey1aAuggb8wRsu.whB9WUJm7Td35gPT9TCv5cBHFUnSj3S', 500);

-- 
-- Dumping data for table LoginDates
--
-- Table bestbank.LoginDates does not contain any data (it is empty)

-- 
-- Dumping data for table JunctionTable
--
INSERT INTO JunctionTable VALUES
('201911190101010101', '26123456785647385647382905');

-- 
-- Dumping data for table Customers
--
INSERT INTO Customers VALUES
('74062456789', 'willsmith20@netpost.com', 'Smith', 'William', '1974-06-24', '+1', '456567678', 'Mr.', 'wilsmi0011', 'peanutButter20', '2019-11-19', 'Active'),
('76062809876', 'annawhite@netpost.com', 'White', 'Anna', '1976-06-28', '+1', '765654543', 'Mrs.', 'annwhi0022', 'mynamesAnna15', '2019-11-19', 'Active'),
('100', 'president@usa.gov', 'Trump', 'Donald', '1946-06-14', '1', '100', 'Mr.', 'dontru0001', '$2y$10$41pAmQszWxFSZCuU0J3S7.aoEFEydfavWnpEFYw7g6qGBtzk9HwKK', '2019-11-29', 'Active'),
('00000000001', 'asfa@gmail.com', 'Malysz', 'Adam', '1924-02-02', '+1', '765654541', 'Mr.', 'adamal0001', '$2y$10$5LqPDQG8B2SKUnNfaR.c6.yOyQWmrEk5oaIhIfEpO21pOSv3zt1Xi', '2019-11-28', 'Active'),
('101', 'realdonaldtrump@twitter.com', 'Trump', 'Donald', '1111-11-11', '+1', '101', 'Mr.', 'dontru0002', '$2y$10$ixZ5kohI85MRAg3xRVNEhOHPXJAvRTx0Ew49HTMPe7T7oWlnpksma', '2019-12-01', 'Active');

-- 
-- Dumping data for table CreditCards
--
INSERT INTO CreditCards VALUES
('4215658072204550', 'Payment card', '26123456785647385647382905', '2023-11-19', '345', '2019-11-19', 'Active', NULL),
('4215654765890767', 'Debit card', '26123456785647385647382905', '2023-11-19', '870', '2019-11-19', 'Active', NULL),
('4215658012341234', 'Debit card', '86123456784480249024505678', '2023-11-19', '210', '2019-11-19', 'Active', NULL);

-- 
-- Dumping data for table CardTypes
--
INSERT INTO CardTypes VALUES
('Debit card'),
('Payment card');

-- 
-- Dumping data for table Adresses
--
INSERT INTO Adresses VALUES
(1, '74062456789', 'Adress', 'Second', '56', 'a', '94203', 'Beverly Hills', 'United States', '2019-11-19', 'Actual', NULL),
(2, '74062456789', 'Correspondence adress', 'Second', '56', 'a', '94203', 'Beverly Hills', 'United States', '2019-11-19', 'Actual', NULL),
(3, '74062456789', 'Registered adress', 'Second', '56', 'a', '94203', 'Beverly Hills', 'United States', '2019-11-19', 'Actual', NULL),
(4, '76062809876', 'Adress', 'Fifth', '76', 'b', '94207', 'Beverly Hills', 'United States', '2019-11-19', 'Actual', NULL),
(5, '76062809876', 'Correspondence adress', 'Palm', '12', '6', '90003', 'Los Angeles', 'United States', '2019-11-19', 'Actual', NULL),
(6, '76062809876', 'Registered adress', 'Fifth', '76', 'b', '94207', 'Beverly Hills', 'United States', '2019-11-19', 'Actual', NULL);

-- 
-- Dumping data for table AccountTypes
--
INSERT INTO AccountTypes VALUES
('Comfort'),
('Personal account'),
('Savings account');

-- 
-- Dumping data for table Accounts
--
INSERT INTO Accounts VALUES
('26123456785647385647382905', 'Personal account', '74062456789', 'My personal account', 3500, '2019-11-19', 'Active', NULL),
('26123456785647385612341234', 'Savings account', '74062456789', 'My savings', 0, '2019-11-19', 'Active', NULL),
('86123456784480249024505678', 'Personal account', '76062809876', 'My personal account', 0, '2019-11-19', 'Active', NULL),
('86123456784480249024505679', 'Personal account', '100', 'Official account', 7000, '2019-11-21', 'Active', NULL),
('86123456784480249024505681', 'Personal account', '100', 'My personal account', 6000, '2019-11-21', 'Active', NULL),
('97123456789691638460799348', 'Comfort', '100', 'White House', 2000, '2019-12-02', 'Active', NULL),
('86123456784480249024517243', 'Savings account', '100', 'Trump Tower', 2000, '2019-12-01', 'Active', NULL);

-- 
-- Restore previous SQL mode
-- 
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;